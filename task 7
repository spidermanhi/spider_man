TASK-7

Program: Writing User Defined Functions/Eval functions for filtering unwanted data in Pig

Aim: To implement the Filtering unwanted data in pig

loudera@quickstart ~]$ hadoop fs -mkdir task7

[cloudera@quickstart ~]$ hadoop fs -put /home/cloudera/Desktop/phonedata.txt /user/cloudera/task7

[cloudera@quickstart ~]$ pig

Step 1: Load the file

Load the text file data in pig, use below command. Change the location as per your 

environment.

grunt> data = load '/user/cloudera/task7/phonedata.txt' using PigStorage('|') as(id:chararray,contype:chararray);

grunt> dump data

grunt> data = FILTER data BY (contype=’POST’ OR contype==’PREP’ OR contype IS NULL OR contype==’ ‘);

grunt> DUMP data;

grunt> c=FOREACH data GENERATE id, (contype IS NULL OR contype == ‘ ‘)?’NA’: contype) 

AS contype;

grunt> DUMP c;



(1A58252,POSTP)
(73VS543,)
(HD52836,PREP)
(8SH356H,POSTP)
(L62HJS5,PEND)
(Q672821,PREP)
(M672GS6,CLS)
(DGSW522,POSTP)
(RAR1729,PEND)
(YE52863,)
(GHS5281,)
(SYY8373,CLS)
