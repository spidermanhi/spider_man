Task8



Hive Commands

Exercise-1: Exploratory Data Analysis(EDA) of Sales using Demographic Data with hive

Connect to hive form cloudera quickstart terminal by typing ‘hive’.

hive> SHOW databases;

hive> CREATE DATABASE sales;

hive>USE sales;

Create a table named ‘sales1’ 

CREATE TABLE sales1(Sales_Executive INT,
Sales_Executive_Name STRING,  Gender STRING,
Age INT,Loc STRING, Sales_in_Rs INT)

ROW FORMAT DELIMITED 
FIELDS TERMINATED BY ‘,’
LINES TERMINATED BY ‘\n’
STORED AS TEXTFILE;

Load data from hdfs into hive table,i.e. sales1

LOAD DATA INPATH ‘/user/cloudera/sample/sales.csv’ into TABLE sales1;





Perform EDA using the following hive queries:

set hive.map.aggr = true;

set hive.execution.engine=tez;



-----------------------------------------------Hive queries----------------------------------------

Find out total sales of the company

SELECT SUM(Sales_in_Rs) FROM sales1;


Find out the max and min sales of the company

SELECT MAX(Sales_in_Rs) FROM sales1;

SELECT MIN(Sales_in_Rs) FROM sales1;



Find out total sales by location

SELECT SUM(Sales_in_Rs) FROM sales1

GROUP BY Loc;



Find out the average sales by location

SELECT AVG(Sales_in_Rs) FROM sales1
GROUP BY Loc;


Count the no. of sales person by location

SELECT COUNT(Sales_Executive) FROM sales1
GROUP BY Loc;



Compare total sales & average sales by gender

Drill down sales performance by age and sales
Drill down sales performance by gender sand sales
Drill down sales performance by location and sales



Exercise-2: Analysis of Queens Library Branches

hive> CREATE DATABASE Libraries;
hive>USE Libraries;

Create a table in hive named ‘Queens_Libraries’ under ‘Libraries’ database:

hive>CREATE TABLE Queens_Libraries (name STRING,   phone STRING, Mn STRING, 
   Tu STRING,   We STRING, Th STRING, Fr STRING, Sa STRING,
  Su STRING, notification STRING,  Location1 STRING)

                                                                      ROW FORMAT DELIMITED 

                                                                      FIELDS TERMINATED BY ','

                                                                      LINES TERMINATED BY ‘\n’              

                                                                      STORED AS TEXTFILE;



Load data from HDFS into hive table, i.e. Queens_Libraries

       hive>LOAD DATA INPATH ‘/user/cloudera/sample/ Queens_Library_Branches.csv’ into TABLE Queens_Libraries;

-----------------------------------------------Hive Queries----------------------------------------------------------------

Find the total number of libraries located in the NY Queens region

         SELECT COUNT(*) FROM Queens_Libraries;



Find the total number of the libraries and their name that are Open on Sunday

SELECT COUNT(*) FROM Queens_Libraries

WHERE Su != 'closed';SELECT name FROM Queens_Libraries WHERE Su != 'closed';



Find the total number of libraries that are no more working in the Queens region and their names

SELECT COUNT(*) FROM Queens_Libraries 

WHERE Mn = 'closed' AND  Tu = 'closed' AND We = 'closed' AND Th = 'closed' AND Fr = 'closed' AND Sa = 'closed' AND Su = 'closed';



SELECT name FROM Queens_Libraries 

WHERE Mn = 'closed' AND  Tu = 'closed' AND We

 = 'closed' AND Th = 'closed' AND Fr = 'closed' AND Sa = 'closed' AND Su = 'closed';

