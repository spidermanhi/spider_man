1. Connect to hive form cloudera quickstart terminal by typing ‘hive’.
2. hive> SHOW databases;
3. hive> CREATE DATABASE sales1;
4. hive>USE sales1;
5. hive> CREATE TABLE sales1(SalesExecutive INT,Name STRING,Gender STRING,Age
INT,Location STRING,SalesRs INT)ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES
TERMINATED BY '\n' STORED AS TEXTFILE;
6. Load data from hdfs into hive table,i.e. sales1
7. hive> LOAD DATA INPATH '/user/cloudera/sample1/sales1.csv' into TABLE sales1;
8. Perform EDA using the following hive queries:
hive> set hive.map.aggr = true;
hive> set hive.execution.engine=tez;
hive> select *from sales1;

Find out total sales of the company
SELECT SUM(SalesRs) FROM sales1;

Find out the max and min sales of the company
SELECT MAX(SalesRs) FROM sales1;
SELECT MIN(SalesRs) FROM sales1;

Find out total sales by location
SELECT SUM(SalesRs) FROM sales1 GROUP BY Location;

4. Find out the average sales by location
SELECT AVG(SalesRs) FROM sales1 GROUP BY Location;

5. Count the no. of sales person by location
SELECT COUNT(SalesExecutive) FROM sales1

ALTER TABLE <current_table_name> RENAME TO <new_table_name>;
hive> ALTER table sales1 rename to sales2;
hive> select *from sales2;

2. ADD Columns
ALTER TABLE <table_name> ADD COLUMNS (<col-name> <data-type> COMMENT ”, <col-name>
<data-type> COMMENT ”, ….. )
hive> alter table sales2 add columns(phonenumber int);

3. CHANGE Column
ALTER TABLE <table_name> CHANGE <column_name> <new_column_name> <new_data_type>;
hive> ALTER TABLE sales2 CHANGE Name Sname STRING;

4.REPLACE Column
ALTER TABLE <table_name> REPLACE COLUMNS (<attribute_name> <data_type>,<attribute_name>
<data_type>,
..
);
hive> ALTER TABLE sales2 REPLACE COLUMNS (Sname STRING);
hive> create table std(name string, age int);
hive> drop table std;

1.hive> create table employee_data (Id int, Name string , Salary float) row format delimited fields terminated by ',' ;
2. Now, load the data into the table.
hive> load data inpath '/user/cloudera/sample1/employee_data.csv' into table employee_data;
hive> select * from employee_data;
hive> select Id, Name, sqrt(Salary) from employee_data;
hive> select max(Salary) from employee_data;
hive> select min(Salary) from employee_data; 
hive> select Id, upper(Name) from employee_data;


5.views:
hive> CREATE VIEW employee_data1 AS SELECT * FROM employee_data WHEREsalary>3000;
hive> select *from employee_data1;

Dropping a View
hive> DROP VIEW employee_data1;

Creating an Index
hive> CREATE INDEX inedx_salary ON TABLE employee_data(salary) AS'org.apache.hadoop.hive.ql.index.compact.CompactIndexHandler' WITH DEFERRED REBUILD ;

hive> SHOW INDEX ON employee_data;
hive> DROP INDEX inedx_salary ON employee_data;

